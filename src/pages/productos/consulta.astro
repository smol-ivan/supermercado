---
import FormHeader from "../../components/FormHeader.astro";
import Layout from "../../layouts/Layout.astro";
import "../../styles/global.css";
---

<Layout>
    <FormHeader title="Consulta de Producto" returnHref="/productos/" />
    <table>
        <thead>
            <tr>
                <th>Clave</th>
                <th>Nombre</th>
                <th>Proveedor</th>
            </tr>
        </thead>
        <tbody id="productTableBody">
            <!-- Los productos se insertarán aquí dinámicamente -->
        </tbody>
    </table>
    <script>
        async function fetchProductos() {
            const response = await fetch("/api/productos/consulta");
            const data = await response.json();
            if (data.message) {
                alert(data.message);
                return;
            }
            const tbody = document.getElementById("productTableBody");
            tbody.innerHTML = ""; // Limpiar el contenido existente
            data.forEach((producto) => {
                const row = document.createElement("tr");
                row.innerHTML = `
                    <td class="border text-lg">${producto.id}</td>
                    <td class="border text-lg">${producto.nombre}</td>
                    <td class="border text-lg">${producto.proveedor}</td>
                `;
                tbody.appendChild(row);
            });
        }

        fetchProductos();
    </script>
    <style>
        @reference "../../styles/global.css";
        table {
            @apply w-1/3 table-auto mx-auto;
        }
        th {
            @apply bg-gray-300 px-6 py-3  text-2xl;
        }
    </style>
</Layout>
